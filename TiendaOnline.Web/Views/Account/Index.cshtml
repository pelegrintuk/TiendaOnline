@{
    ViewData["Title"] = "Mi Perfil";
}

@if (!User.Identity.IsAuthenticated)
{
    <p>Inicia sesión para acceder a tu perfil.</p>
    <a href="/Account/Login" class="btn btn-primary">Iniciar Sesión</a>
    <a href="/Account/Register" class="btn btn-secondary">Registrarse</a>
}
else
{
    <h1>Mi Perfil</h1>
    <div id="user-profile">
        <p>Cargando perfil...</p>
    </div>

    <script>
        const userId = '@User.Identity.Name';

        async function loadUserProfile() {
            try {
                const response = await fetch(`/api/Users/${userId}`);
                if (response.ok) {
                    const user = await response.json();
                    renderUserProfile(user);
                } else {
                    document.getElementById('user-profile').innerHTML = '<p>Error al cargar el perfil</p>';
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('user-profile').innerHTML = '<p>Error al cargar el perfil</p>';
            }
        }

        function renderUserProfile(user) {
            document.getElementById('user-profile').innerHTML = `
                        <p><strong>Nombre de Usuario:</strong> ${user.username}</p>
                        <p><strong>Correo Electrónico:</strong> ${user.email}</p>
                        <p><strong>Dirección:</strong> ${user.address.street}, ${user.address.city}, ${user.address.state}, ${user.address.zipCode}, ${user.address.country}</p>
                    `;
        }

        loadUserProfile();
    </script>
}
